<div id="page-transcode-new" class="container">
  <div class="columns">
    <div class="column">
      <h1>Stream Target</h1>
    </div>
  </div>
  <div class="columns">
    <div class="column is-full-mobile is-half-desktop">
      <form action="<%= env['REQUEST_URI'] %>" accept-charset="UTF-8" data-remote="true" method="post">
      
        <div class="field">
          <label class="label">Profile Name</label>
          <div class="control">
            <input id="ProfileName" class="input my-2" type="text" name="name" placeholder="Profile Name">
          </div>
        </div>

        <div class="field">
          <label class="label">Transcode Profile</label>
          <div class="control">
            <div class="select">
              <select id="TranscodeProc" name="input_name">
                <option value="">--- Select Transcode Process ---</option>
                <% @transcodes.each do | transcode |%>
                <option value="<%= transcode['name'] %>"><%= transcode['name'] %></option>
                <%end%>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Stream Target</label>
          <div class="control">
            <input id="TargetURL" class="input my-2" type="text" name="target_url" placeholder="Target URL">
            <input id="TargetKey" class="input my-2" name="target_key" placeholder="Target Stream Key">
          </div>
        </div>

        <div class="field is-grouped">
          <div class="control">
            <button class="button is-link">Submit</button>
          </div>
          <div class="control">
            <button class="button is-link is-light">Cancel</button>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="column is-full-mobile is-half-desktop">
  </div>
</div>

<% if request.path_info.split('/')[2] == "edit" %>
<script>
$(document).ready(function() {
  var target_stream = <%= @target_stream.to_json %>;
  $('#ProfileName').val(target_stream.name);
  $('#TargetURL').val(target_stream.target_url);
  $('#TargetKey').val(target_stream.target_key);

  if (target_stream.input_name != null) {
    $('#TranscodeProc').val(target_stream.input_name);
  } else {
    $('#TranscodeProc').val("none");
  }

  $("#TranscodeProc").trigger("change");
});
</script>
<% end %>